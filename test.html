<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="jspsych/jspsych.js"></script>
    <link href="jspsych/css/jspsych.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="styling2.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="jspsych/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych/plugins/jspsych-image-button-response.js"></script>
    <script src="jspsych/plugins/jspsych-instructions.js"></script>
    <script src="jspsych/plugins/jspsych-image-slider-response.js"></script>
    <script src="jspsych/plugins/jspsych-html-button-response.js"></script>
    <script src="jspsych/plugins/jspsych-resize.js"></script>
    <script src="jspsych\plugins\jspsych-call-function.js"></script>
    <script src="jspsych\plugins\jspsych-image-slider-response.js"></script>
    <script src= "jspsych\plugins\jspsych-html-slider-response-custom.js"></script>
    <script src="jspsych\plugins\jspsych-survey-likert.js"></script>
    <script src="jspsych\plugins\jspsych-survey-text.js"></script>
    <script src="jspsych\plugins\jspsych-survey-text-custom.js"></script>
    <script src="jspsych\plugins\jspsych-html-vas-custom.js"></script>
</head>
<body>
</body>

<script>



var timeline = [];

var pics = ["img/1 AF-205.jpg", "img/1 AF-224.jpg"];
var radio_rating = 0;
var sum_dur = 0;
var confidence_dur = 0;
var choice_dur = 0;

var inputs = {
    type: 'resize',
    item_width: 3 + 3/8,
    item_height: 2 + 1/8,
    prompt: "<h1> Calibration </h1><p>Click and drag the lower right corner of the box until the box is the same size as a credit card held up to the screen. <br> When the rectangle has the same size as the card, press continue</p>",
    pixels_per_unit: 150,
};
timeline.push(inputs);


console.log(pics[0]);
var delibiration = {
    type: "html-keyboard-response",
    stimulus: function(){

        stim =  "<div class = 'main_div'>" +
             "<div class='left_stim'><img class = 'central_stim' src='"+pics[0]+"' </img> </div>" +
            "<div class='right_stim'><img class = 'central_stim' src='"+pics[1]+"' </img> </div>" +
            "</div>"
        
    
    return stim
    
    },
    choices: jsPsych.NO_KEYS,
        trial_duration: 4000,
};
timeline.push(delibiration);


button_choice=['<button id = "left_button">Left</button>','<button id = "right_button">Right</button>'];

var choice = {
    type: 'html-button-response',
    button_html: button_choice,
    choices: ["Left Face","Right Face"],
    stimulus: 
            "<div class = 'main_div'>" +
            "<div class='left_stim'><img class = 'central_stim' src='"+'img/cardback1o.jpg'+"' </img> </div>" +
            "<div class='right_stim'><img class = 'central_stim' src='"+'img/cardback2o.jpg'+"' </img> </div>" +
            "</div>",
    on_finish: function(data){
        choice_dur=data.rt;
    }
}

timeline.push(choice);


myRadio = document.querySelector("input[name='sl2']");
    function radioClick(v) {
      let rb = 'sl2_' + v;  // match the id of each option, here "sl2_1", "sl2_2", etc.
      document.getElementById(rb).checked = true;
      radio_rating=v;
      document.querySelector('#jspsych-html-slider-response-next').disabled = false;//enable button to continue
    }



button_conf=[
    '<button class="button_confidence">Continue</button>'];

var scale = {
    type: 'html-vas-custom',
    stimulus: function(){
        stim = 

        "<div class = 'main_div'>" +        
        "<div class='left_stim'><img class = 'central_stim_selected' src='"+'img/cardback1o.jpg'+"' </img>  </div>" +
        "<div class='right_stim'><img class = 'central_stim' src='"+'img/cardback2o.jpg'+"' </img> </div>"+


                "<table>" +
                    "<tr>" +
                        "<td class='leftTdVas'>0<br>Not very<br>strong</td>" +
                        "<td>" +
                            "<div class = 'slider_tick_container'>"+
                                "<img src='responseScales/vas_banded.png' id='customSlider2'>" +
                                "<div id='customTick2' class='customTick2'>" +
                                '<img id="customTick2_fig" src="responseScales/tick2.png" width="30px" height="30px">'+
                        "</td>" +
                        "<td class='rightTdVas'>100<br>Very<br>strong</td>" +
                    "</tr>" +
                    "<tr>" +
                        "<td colspan='3'>" +
                            "<div id='mySlider5_value'></div>" +
                        "</td>" +
                    "</tr>" +
                    "</div>"+
                "</table>"+
        "</div>"
        return stim
    },
    require_movement:true,
    button_label:"Continue",
    button_html: button_conf,
    on_finish: function(data){
        confidence_dur=data.rt;
        sum_dur= choice_dur+confidence_dur;
        }
}

var delay_cardback2 = {
        type: "html-keyboard-response",
        stimulus:function(){
        var stim = 
            "<div class = 'main_div'>" +     
            "<p>  Please wait </p>" + 
            "<div class='left_stim'><img class = 'central_stim_selected' src='"+'img/cardback1o.jpg'+"' </img>  </div>" +
            "<div class='right_stim'><img class = 'central_stim' src='"+'img/cardback2o.jpg'+"' </img> </div>"
        return stim
        },

        choices: jsPsych.NO_KEYS,
        data: {screen_id: "delay_cardback2"},
        trial_duration:function(){
        var dur= null;
            (function(){
                dur=7000-sum_dur;
                if (dur<0) {dur=0};})()
        console.log(dur,"dur computed on cardback2")
        return dur}
        }; 

timeline.push(delay_cardback2);



timeline.push(scale);

jsPsych.init({
    show_progress_bar: true,
    timeline: timeline,
})



</script>
</html>